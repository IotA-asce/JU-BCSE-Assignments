CREATE TABLE DEPT_AS3(
	DEPT_CODE CHAR(6) PRIMARY KEY,
	DEPT_NAME CHAR(15)
);

create table EMP_AS3(
	EMP_CODE CHAR(5) PRIMARY KEY,
	EMP_NAME CHAR(20) CHECK(EMP_NAME=UPPER(EMP_NAME)),
	DEPT_CODE CHAR(5),
	ADDRESS CHAR(25),
	BASIC Number CHECK(BASIC>=5000 AND BASIC<=9000),
	GRADE CHAR(1) CHECK(GRADE='A' OR GRADE='B' OR GRADE='C'),
	JN_DT Date
	);
	
CREATE TABLE LEAVE_AS3(
	EMP_CODE CHAR(5),
	LEAVE_TYPE CHAR(2) CHECK(LEAVE_TYPE='CL' OR LEAVE_TYPE='ML' OR LEAVE_TYPE='EL'),
	FROM_DATE Date,
	TO_DATE Date
);

INSERT INTO EMP_AS3 VALUES('EMP1','AVIRUP','DPT1','KOLKATA-97',6000,'C','1-JUL-2011');
INSERT INTO EMP_AS3 VALUES('EMP1','AVIRUP','DPT1','KOLKATA-97',6000,'D','1-JUL-2011');
INSERT INTO EMP_AS3 VALUES('EMP1','AVIRUP','DPT1','KOLKATA-97',60000,'C','1-JUL-2011');
INSERT INTO EMP_AS3 VALUES('EMP1','AVIruP','DPT1','KOLKATA-97',6000,'C','1-JUL-2011');
INSERT INTO EMP_AS3 VALUES('EMP2','AVIK','DPT2','KOLKATA-91',6720,'C','1-JUL-2011');
INSERT INTO EMP_AS3 VALUES('EMP3','AVIGYAN','DPT4','KOLKATA-59',7800,'C','1-JUL-2011');
INSERT INTO EMP_AS3 VALUES('EMP4','AVILASH','DPT3','KOLKATA-17',5600,'C','1-JUL-2011');
INSERT INTO EMP_AS3 VALUES('EMP5','AVIJIT','DPT2','KOLKATA-07',8900,'C','1-JUL-2011');

INSERT INTO EMP_AS3 VALUES('EMP6','AKASH','DPT2','KOLKATA-07',7000,'C','1-JUL-2011');

INSERT INTO EMP_AS3 VALUES('EMP7','AAKASH','DPT2','KOLKATA-07',7000,'B','1-JUL-2011');
INSERT INTO EMP_AS3 VALUES('EMP8','ASHUTOSH','DPT3','KOLKATA-07',7000,'A','1-JUL-2011');

INSERT INTO LEAVE_AS3 VALUES('EMP1','CL', '2-JAN-2010', '3-MAR-2010');

INSERT INTO DEPT_AS3 VALUES('DPT1','CSE');
INSERT INTO DEPT_AS3 VALUES('DPT2','ECE');
INSERT INTO DEPT_AS3 VALUES('DPT3','CE');
INSERT INTO DEPT_AS3 VALUES('DPT4','ME');

INSERT INTO LEAVE_AS3 VALUES('EMP1','DL', '2-JAN-2010', '3-MAR-2010');

CREATE TABLE REC AS SELECT EMP_AS3.EMP_CODE AS CODE,EMP_AS3.EMP_NAME AS NAME,DEPT_AS3.DEPT_NAME AS DPT,BASIC FROM EMP_AS3,DEPT_AS3 WHERE EMP_AS3.DEPT_CODE=DEPT_AS3.DEPT_CODE AND BASIC=7000 AND DEPT_AS3.DEPT_NAME='ECE';

INSERT INTO REC(CODE, NAME, DPT, BASIC) SELECT EMP_AS3.EMP_CODE, EMP_AS3.EMP_NAME, DEPT_AS3.DEPT_NAME, BASIC FROM EMP_AS3, DEPT_AS3 WHERE EMP_AS3.DEPT_CODE=DEPT_AS3.DEPT_CODE AND BASIC > 7000;
